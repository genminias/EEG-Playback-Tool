(this["webpackJsonpeeg-playback-app"]=this["webpackJsonpeeg-playback-app"]||[]).push([[0],{19:function(e,t,c){},27:function(e,t){function c(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}c.keys=function(){return[]},c.resolve=c,e.exports=c,c.id=27},30:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c.n(n),s=c(9),i=c.n(s),r=(c(19),c(3)),o=c(4),u=c(2),l=c(11),j=c(12),b=c.n(j),d=c(1),f=new l.Notion({autoSelectDevice:!1}),O={selectedDevice:null,status:null,user:null,loadingUser:!0},h=Object(n.createContext)(),v=function(){return Object(n.useContext)(h)};function m(e){var t=e.children,c=function(){var e=b()("deviceId"),t=Object(u.a)(e,2),c=t[0],a=t[1],s=Object(n.useState)(Object(o.a)({},O)),i=Object(u.a)(s,2),r=i[0],l=i[1],j=r.user,d=r.selectedDevice,h=Object(n.useCallback)((function(e){l((function(t){return Object(o.a)(Object(o.a)({},t),{},{selectedDevice:e})}))}),[]);Object(n.useEffect)((function(){j&&!d&&f.selectDevice((function(e){return c?e.find((function(e){return e.deviceId===c})):e[0]}))}),[j,c,d]),Object(n.useEffect)((function(){if(d){var e=f.status().subscribe((function(e){l((function(t){return Object(o.a)(Object(o.a)({},t),{},{status:e})}))}));return function(){e.unsubscribe()}}}),[d]),Object(n.useEffect)((function(){l((function(e){return Object(o.a)(Object(o.a)({},e),{},{loadingUser:!0})}));var e=f.onAuthStateChanged().subscribe((function(e){l((function(t){return Object(o.a)(Object(o.a)({},t),{},{user:e,loadingUser:!1})}))}));return function(){e.unsubscribe()}}),[]),Object(n.useEffect)((function(){var e=f.onDeviceChange().subscribe((function(e){h(e),a(e.deviceId)}));return function(){e.unsubscribe()}}),[h,a]);var v=Object(n.useCallback)((function(){return new Promise((function(e){f.logout().then(e),l(Object(o.a)(Object(o.a)({},O),{},{loadingUser:!1}))}))}),[]);return Object(o.a)(Object(o.a)({},r),{},{lastSelectedDeviceId:c,setLastSelectedDeviceId:a,logoutNotion:v,setSelectedDevice:h})}();return Object(d.jsx)(h.Provider,{value:c,children:t})}function g(){var e=v(),t=e.user,c=e.lastSelectedDeviceId,a=Object(n.useState)([]),s=Object(u.a)(a,2),i=s[0],o=s[1],l=Object(n.useState)(""),j=Object(u.a)(l,2),b=j[0],O=j[1],h=Object(n.useState)(!0),m=Object(u.a)(h,2),g=m[0],x=m[1],p=Object(n.useState)(!1),N=Object(u.a)(p,2),S=N[0],y=N[1],D=Object(n.useState)(""),w=Object(u.a)(D,2),C=w[0],k=w[1];return Object(n.useEffect)((function(){t&&!S&&(x(!0),f.getDevices().then((function(e){o(e),e.length&&O(c||e[0].deviceId)})).catch((function(e){k(e.message)})).finally((function(){x(!1)})))}),[t,c,S]),Object(d.jsx)("main",{className:"main-container",children:Object(d.jsxs)("form",{className:"card login-form",onSubmit:function(e){e.preventDefault(),y(!0),f.selectDevice((function(e){return e.find((function(e){return e.deviceId===b}))})).then((function(){Object(r.c)("/")})).catch((function(e){k(e.message)}))},children:[Object(d.jsx)("h3",{className:"card-heading",children:"Devices"}),C?Object(d.jsx)("h4",{className:"card-error",children:C}):null,Object(d.jsxs)("div",{className:"row",children:[Object(d.jsx)("label",{children:"Select a Device"}),Object(d.jsx)("select",{name:"deviceSelect",value:b,disabled:g,onChange:function(e){return O(e.target.value)},children:i.map((function(e){return Object(d.jsx)("option",{value:e.deviceId,children:e.deviceNickname||e.modelName},e.deviceId)}))})]}),Object(d.jsx)("div",{className:"row",children:Object(d.jsx)("button",{type:"submit",className:"card-btn",disabled:g,children:g?"Loading Devices...":"Select"})})]})})}function x(){return Object(d.jsx)("div",{className:"loading-container",children:Object(d.jsx)("div",{className:"loading-spinner"})})}var p=c(6),N=c.n(p),S=c(13),y=c(14),D=c.n(y);function w(e){var t=e.onLogin,c=e.loading,a=e.error,s=e.footerComponent,i=Object(n.useState)(""),r=Object(u.a)(i,2),o=r[0],l=r[1],j=Object(n.useState)(""),b=Object(u.a)(j,2),f=b[0],O=b[1];return Object(d.jsxs)("form",{className:"card login-form",onSubmit:function(e){e.preventDefault(),t({email:o,password:f})},children:[Object(d.jsx)("h3",{className:"card-heading",children:"Login"}),a?Object(d.jsx)("h4",{className:"card-error",children:a}):null,Object(d.jsxs)("div",{className:"row",children:[Object(d.jsx)("label",{children:"Email"}),Object(d.jsx)("input",{type:"email",value:o,disabled:c,onChange:function(e){return l(e.target.value)}})]}),Object(d.jsxs)("div",{className:"row",children:[Object(d.jsx)("label",{children:"Password"}),Object(d.jsx)("input",{type:"password",value:f,disabled:c,onChange:function(e){return O(e.target.value)}})]}),Object(d.jsx)("div",{className:"row",children:Object(d.jsx)("button",{type:"submit",className:"card-btn",disabled:c,children:c?"Logging in...":"Login"})}),s]})}function C(){return Object(d.jsxs)("footer",{className:"card-footer",children:[Object(d.jsx)("a",{className:"card-link card-footer-cta",href:"https://github.com/neurosity/notion-react-starter",target:"_blank",rel:"noopener noreferrer",children:"View source code"}),Object(d.jsxs)("div",{className:"card-footer-credits",children:["Built by"," ",Object(d.jsx)("a",{className:"card-link",href:"https://neurosity.co",target:"_blank",rel:"noopener noreferrer",children:"Neurosity"})]})]})}function k(){var e=v(),t=e.user,c=e.lastSelectedDeviceId,a=e.setSelectedDevice,s=Object(n.useState)(""),i=Object(u.a)(s,2),o=i[0],l=i[1],j=Object(n.useState)(""),b=Object(u.a)(j,2),O=b[0],h=b[1],m=Object(n.useState)(""),g=Object(u.a)(m,2),x=g[0],p=g[1],y=Object(n.useState)(!1),k=Object(u.a)(y,2),E=k[0],I=k[1];function L(){p(""),l(""),h("")}return D()((function(){t&&Object(r.c)("/")})),Object(n.useEffect)((function(){function e(){return(e=Object(S.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I(!0),e.next=3,f.login({email:o,password:O}).catch((function(e){p(e.message)}));case 3:e.sent&&(L(),c?Object(r.c)("/"):Object(r.c)("/devices")),I(!1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}o&&O&&function(){e.apply(this,arguments)}()}),[o,O,p,c,a]),Object(d.jsx)("main",{className:"main-container",children:Object(d.jsx)(w,{onLogin:function(e){var t=e.email,c=e.password;t&&c?(p(""),l(t),h(c)):p("Please fill the form")},error:x,loading:E,footerComponent:Object(d.jsx)(C,{})})})}function E(){var e=v().logoutNotion;return Object(n.useEffect)((function(){e().then((function(){Object(r.c)("/")}))}),[e]),null}var I={booting:"Starting OS...",shuttingOff:"Shutting off...",updating:"Updating OS...",online:"Online",offline:"Offline"},L={booting:"darkslategrey",shuttingOff:"darkslategrey",updating:"orange",online:"limegreen",offline:"crimson"};function U(){var e=v(),t=e.status,c=e.selectedDevice,n=t||{},a=n.state,s=n.charging,i=n.battery,o=n.sleepMode;return t?Object(d.jsxs)("aside",{children:[c?Object(d.jsx)("h3",{className:"card-heading",children:Object(d.jsxs)(r.a,{to:"/devices",title:"My Devices",className:"unstyled-link",children:[Object(d.jsx)("span",{role:"img","aria-label":"My Devices",children:"\u2699\ufe0f"}),"\xa0\xa0",c.deviceNickname]})}):null,Object(d.jsxs)("div",{className:"status-item status-state",children:[Object(d.jsx)("span",{className:"status-indicator",style:{background:M(a)}}),a in I?I[a]:a]}),"offline"!==a?Object(d.jsxs)("div",{className:"status-item status-battery",children:[Object(d.jsx)(P,{})," \xa0",s?"Charging":"Charged","\xa0",i,"%"]}):null,o&&"offline"!==a?Object(d.jsxs)("div",{className:"status-item status-sleep-mode",children:[Object(d.jsx)(F,{})," \xa0Sleep mode"]}):null]}):Object(d.jsx)("div",{children:"Connecting to device..."})}function M(e){return e in L?L[e]:L.offline}function P(){return Object(d.jsx)("span",{role:"img","aria-label":"Electricity",children:"\u26a1"})}function F(){return Object(d.jsx)("span",{role:"img","aria-label":"The Moon",children:"\ud83c\udf19"})}function T(){return Object(d.jsxs)("nav",{className:"card",children:[Object(d.jsx)(U,{}),Object(d.jsx)("button",{onClick:function(){Object(r.c)("/logout")},className:"card-btn",children:"Logout"}),Object(d.jsx)(C,{})]})}function _(){var e=v().user,t=Object(n.useState)(0),c=Object(u.a)(t,2),a=c[0],s=c[1];return Object(n.useEffect)((function(){e||Object(r.c)("/login")}),[e]),Object(n.useEffect)((function(){if(e){var t=f.calm().subscribe((function(e){var t=Math.trunc(100*e.probability);s(t)}));return function(){t.unsubscribe()}}}),[e]),Object(d.jsxs)("main",{className:"main-container",children:[e?Object(d.jsx)(T,{}):null,Object(d.jsxs)("div",{className:"calm-score",children:["\xa0",a,"% ",Object(d.jsx)("div",{className:"calm-word",children:"Calm"})]})]})}function B(){return Object(d.jsx)(m,{children:Object(d.jsx)(J,{})})}function J(){var e=v(),t=e.user,c=e.loadingUser;return Object(n.useEffect)((function(){c||t||Object(r.c)("/login")}),[t,c]),c?Object(d.jsx)(x,{}):Object(d.jsxs)(r.b,{children:[Object(d.jsx)(_,{path:"/"}),Object(d.jsx)(g,{path:"/devices"}),Object(d.jsx)(k,{path:"/login"}),Object(d.jsx)(E,{path:"/logout"})]})}var A=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,31)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;c(e),n(e),a(e),s(e),i(e)}))};i.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(B,{})}),document.getElementById("root")),A()}},[[30,1,2]]]);
//# sourceMappingURL=main.c3f12b83.chunk.js.map